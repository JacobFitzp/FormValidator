(()=>{"use strict";const t=function(){};var n,e=(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});const i=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.breakSequence=!1,n}return e(n,t),n.prototype.check=function(t,n){return n.regexp.test(t)},n}(t);var r=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();const o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return r(n,t),n.prototype.check=function(t,n){return!(t.length<n.min||t.length>n.max)},n}(t),s=function(){function t(){this.breakSequence=!0}return t.prototype.check=function(t,n){return t.length>0},t}(),l=function(){function n(){}return n.registerValidator=function(t,n){return this.validatorMap[t]=n,self},n.getValidatorInstance=function(n){var e=this.validatorMap[n];return e instanceof t?e:null},n.validatorMap={regexp:new i,stringLength:new o,notEmpty:new s},n}(),u=function(){function t(t){this.form=t}return t.prototype.validate=function(t,n){for(var e={valid:!0,messages:[],failedValidators:[]},i=0,r=Object.entries(n);i<r.length;i++){var o=r[i],s=o[0],u=o[1],a=l.getValidatorInstance(s);if(!a.check(t,u)&&(e.valid=!1,e.messages.push(u.message),e.failedValidators.push(s),a.breakSequence))return e}return e},t}(),a=function(){function t(){}return t.bind=function(t){this.plugins=t.plugins,this.plugins.length&&this.getPlugins().forEach((function(n){n.init(),t.on("fv.field.invalid",(function(t){n.onFieldInvalid(t.field,t.result)})),t.on("fv.field.valid",(function(t){n.onFieldValid(t.field)})),t.on("fv.form.invalid",(function(){n.onFormInvalid()}))}))},t.addPlugin=function(t){return this.plugins.push(t),!1},t.getPlugins=function(){return this.plugins},t}(),f=function(){function t(t){this.form=t}return t.prototype.buildCustomEvent=function(t,n){return new CustomEvent(t,{cancelable:!1,detail:n})},t.prototype.triggerEvent=function(t,n){this.form.dispatchEvent(this.buildCustomEvent(t,n))},t.prototype.triggerInvalidField=function(t,n){this.triggerEvent("fv.field.invalid",{form:this.form,field:t,result:n})},t.prototype.triggerValidField=function(t){this.triggerEvent("fv.field.valid",{form:this.form,field:t})},t.prototype.triggerInvalidForm=function(){this.triggerEvent("fv.form.invalid",{form:this.form})},t}();!function(){function t(t,n){this.form=t,this.options=n,this.fieldValidator=new u(t),this.eventHandler=new f(t),this.plugins=n.plugins||[],this.registerEventListeners(),a.bind(this)}t.prototype.on=function(t,n){this.form.addEventListener(t,(function(t){n(t)}))},t.prototype.addField=function(t,n){return this.options.fields[t]=n,this.registerEventListenersForField(this.getFieldElement(t),t),this},t.prototype.getFields=function(){return Object.keys(this.options.fields)},t.prototype.getField=function(t){return this.options.fields[t]},t.prototype.getFieldElement=function(t){return this.form.querySelector('[name="'+t+'"]')},t.prototype.getFieldElements=function(){var t=[];for(var n in this.options.fields)t.push(this.getFieldElement(n));return t},t.prototype.validateField=function(t){var n=this.getFieldElement(t),e=this.getField(t),i=this.fieldValidator.validate(n.value,e);return i.valid?this.eventHandler.triggerValidField(t):(this.eventHandler.triggerInvalidField(t,i),this.valid=!1),this},t.prototype.validateForm=function(){var t=this;return this.valid=!0,this.getFields().forEach((function(n){t.validateField(n)})),this},t.prototype.isFormValid=function(){return this.valid},t.prototype.registerEventListenersForField=function(t,n){var e=this;null!==t.getAttribute("value")&&this.validateField(n),t.addEventListener("input",(function(t){e.validateField(n)}))},t.prototype.registerEventListeners=function(){var t=this;this.getFields().forEach((function(n){t.registerEventListenersForField(t.getFieldElement(n),n)})),this.form.addEventListener("submit",(function(n){n.preventDefault(),t.validateForm(),t.isFormValid()&&t.handleSubmit(n)}))},t.prototype.handleSubmit=function(t){if(this.options.submitCallback instanceof Function&&this.options.submitCallback(t))return!0;this.form.submit()}}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FDekJxRCxFQUFvQixNQUNwQkMsR0FjUixPQVBLakMsRUFBT2xCLE1BSVJYLEtBQUs2QyxhQUFhSixrQkFBa0JiLElBSHBDNUIsS0FBSzZDLGFBQWFMLG9CQUFvQlosRUFBT0MsR0FDN0M3QixLQUFLVyxPQUFRLEdBS1ZYLE1BTVgsWUFBQStELGFBQUEsc0JBZ0JJLE9BVEEvRCxLQUFLVyxPQUFRLEVBS2JYLEtBQUtzRCxZQUFZaEMsU0FBUSxTQUFDTSxHQUN0QixFQUFLZ0MsY0FBY2hDLE1BR2hCNUIsTUFNWCxZQUFBZ0UsWUFBQSxXQUVJLE9BQU9oRSxLQUFLVyxPQVVSLFlBQUF5QywrQkFBUixTQUF1Q3hCLEVBQW9CK0IsR0FBM0QsV0FFd0MsT0FBaEMvQixFQUFNcUMsYUFBYSxVQUNuQmpFLEtBQUs0RCxjQUFjRCxHQUd2Qi9CLEVBQU1xQixpQkFBaUIsU0FBUyxTQUFDdkIsR0FDN0IsRUFBS2tDLGNBQWNELE9BU25CLFlBQUFiLHVCQUFSLHNCQUVJOUMsS0FBS3NELFlBQVloQyxTQUFRLFNBQUNNLEdBQ3RCLEVBQUt3QiwrQkFBK0IsRUFBS0MsZ0JBQWdCekIsR0FBUUEsTUFHckU1QixLQUFLTyxLQUFLMEMsaUJBQWlCLFVBQVUsU0FBQ3ZCLEdBQ2xDQSxFQUFNd0MsaUJBQ04sRUFBS0gsZUFFRCxFQUFLQyxlQUNMLEVBQUtHLGFBQWF6QyxPQVd0QixZQUFBeUMsYUFBUixTQUFxQnpDLEdBUWpCLEdBQUkxQixLQUFLMkMsUUFBUXlCLDBCQUEwQkMsVUFDMUJyRSxLQUFLMkMsUUFBUXlCLGVBQWUxQyxHQUdyQyxPQUFPLEVBSWYxQixLQUFLTyxLQUFLK0QsVUF6TmxCLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AamFjb2JmaXR6cC9mb3JtdmFsaWRhdG9yLy4vc3JjL0NvcmUvVmFsaWRhdG9yL1ZhbGlkYXRvci50cyIsIndlYnBhY2s6Ly9AamFjb2JmaXR6cC9mb3JtdmFsaWRhdG9yLy4vc3JjL1ZhbGlkYXRvcnMvUmVnZXhWYWxpZGF0b3IudHMiLCJ3ZWJwYWNrOi8vQGphY29iZml0enAvZm9ybXZhbGlkYXRvci8uL3NyYy9WYWxpZGF0b3JzL1N0cmluZ0xlbmd0aFZhbGlkYXRvci50cyIsIndlYnBhY2s6Ly9AamFjb2JmaXR6cC9mb3JtdmFsaWRhdG9yLy4vc3JjL1ZhbGlkYXRvcnMvTm90RW1wdHlWYWxpZGF0b3IudHMiLCJ3ZWJwYWNrOi8vQGphY29iZml0enAvZm9ybXZhbGlkYXRvci8uL3NyYy9Db3JlL1ZhbGlkYXRvci9WYWxpZGF0b3JNYW5hZ2VyLnRzIiwid2VicGFjazovL0BqYWNvYmZpdHpwL2Zvcm12YWxpZGF0b3IvLi9zcmMvQ29yZS9GaWVsZFZhbGlkYXRvci9GaWVsZFZhbGlkYXRvci50cyIsIndlYnBhY2s6Ly9AamFjb2JmaXR6cC9mb3JtdmFsaWRhdG9yLy4vc3JjL0NvcmUvUGx1Z2luL1BsdWdpbk1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vQGphY29iZml0enAvZm9ybXZhbGlkYXRvci8uL3NyYy9Db3JlL0V2ZW50L0V2ZW50SGFuZGxlci50cyIsIndlYnBhY2s6Ly9AamFjb2JmaXR6cC9mb3JtdmFsaWRhdG9yLy4vc3JjL0NvcmUvRm9ybVZhbGlkYXRvci9Gb3JtVmFsaWRhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQWJzdHJhY3QgVmFsaWRhdG9yXG4gKlxuICogQGF1dGhvciBKYWNvYiBGaXR6cGF0cmljayA8Y29udGFjdEBqYWNvYmZpdHpwLmNvLnVrPlxuICovXG5pbXBvcnQge1JlcXVpcmVkUGFyYW1zfSBmcm9tIFwiLi9UeXBlcy9SZXF1aXJlZFBhcmFtc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBWYWxpZGF0b3JcbntcbiAgICAvKipcbiAgICAgKiBTaG91bGQgdGhpcyB2YWxpZGF0b3IgYnJlYWsgdGhlIHNlcXVlbmNlLlxuICAgICAqIElmIHRydWUgdGhlIHNlcXVlbmNlIG9mIFZhbGlkYXRvcnMgd2lsbCBiZSBicm9rZW4gb25cbiAgICAgKiBhbiBpbnZhbGlkIGZpZWxkLCBhbmQgbm8gYWRkaXRpb25hbCBWYWxpZGF0b3JzIGFmdGVyXG4gICAgICogdGhpcyBvbmUgd2lsbCBiZSBjaGVjaGVkIGFnYWluc3QuXG4gICAgICovXG4gICAgYnJlYWtTZXF1ZW5jZTogYm9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGEgZ2l2ZW4gdmFsdWUgcGFzc2VzIHZhbGlkYXRpb24uXG4gICAgICogUmV0dXJucyBhIHByb21pc2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBwYXJhbXNcbiAgICAgKi9cbiAgICBhYnN0cmFjdCBjaGVjayh2YWx1ZTogc3RyaW5nLCBwYXJhbXM6IG9iamVjdCk6IGJvb2xlYW47XG59IiwiaW1wb3J0IFZhbGlkYXRvciBmcm9tICcuLi9Db3JlL1ZhbGlkYXRvci9WYWxpZGF0b3InO1xuXG4vKipcbiAqIFJlZ2V4IFZhbGlkYXRvclxuICpcbiAqIEBhdXRob3IgSmFjb2IgRml0enBhdHJpY2sgPGNvbnRhY3RAamFjb2JmaXR6cC5jby51az5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVnZXhWYWxpZGF0b3IgZXh0ZW5kcyBWYWxpZGF0b3JcbntcbiAgICBicmVha1NlcXVlbmNlID0gZmFsc2U7XG5cbiAgICBjaGVjayh2YWx1ZTogc3RyaW5nLCBwYXJhbXM6IG9iamVjdCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gcGFyYW1zWydyZWdleHAnXS50ZXN0KHZhbHVlKTtcbiAgICB9XG59IiwiaW1wb3J0IFZhbGlkYXRvciBmcm9tICcuLi9Db3JlL1ZhbGlkYXRvci9WYWxpZGF0b3InO1xuXG4vKipcbiAqIFN0cmluZyBMZW5ndGhcbiAqXG4gKiBAYXV0aG9yIEphY29iIEZpdHpwYXRyaWNrIDxjb250YWN0QGphY29iZml0enAuY28udWs+XG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0cmluZ0xlbmd0aFZhbGlkYXRvciBleHRlbmRzIFZhbGlkYXRvclxue1xuICAgIGJyZWFrU2VxdWVuY2U6IGZhbHNlO1xuXG4gICAgY2hlY2sodmFsdWU6IHN0cmluZywgcGFyYW1zOiBvYmplY3QpOiBib29sZWFuIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gISh2YWx1ZS5sZW5ndGggPCBwYXJhbXMubWluIHx8IHZhbHVlLmxlbmd0aCA+IHBhcmFtcy5tYXgpO1xuICAgIH1cbn0iLCJpbXBvcnQgVmFsaWRhdG9yIGZyb20gJy4uL0NvcmUvVmFsaWRhdG9yL1ZhbGlkYXRvcic7XG5cbi8qKlxuICogUmVnZXggVmFsaWRhdG9yXG4gKlxuICogQGF1dGhvciBKYWNvYiBGaXR6cGF0cmljayA8Y29udGFjdEBqYWNvYmZpdHpwLmNvLnVrPlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb3RFbXB0eVZhbGlkYXRvciBpbXBsZW1lbnRzIFZhbGlkYXRvclxue1xuICAgIGJyZWFrU2VxdWVuY2UgPSB0cnVlO1xuXG4gICAgY2hlY2sodmFsdWU6IHN0cmluZywgcGFyYW1zOiBvYmplY3QpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmxlbmd0aCA+IDBcbiAgICB9XG59IiwiaW1wb3J0IFJlZ2V4VmFsaWRhdG9yIGZyb20gXCIuLi8uLi9WYWxpZGF0b3JzL1JlZ2V4VmFsaWRhdG9yXCI7XG5pbXBvcnQgU3RyaW5nTGVuZ3RoVmFsaWRhdG9yIGZyb20gXCIuLi8uLi9WYWxpZGF0b3JzL1N0cmluZ0xlbmd0aFZhbGlkYXRvclwiO1xuaW1wb3J0IFZhbGlkYXRvciBmcm9tIFwiLi9WYWxpZGF0b3JcIjtcbmltcG9ydCBOb3RFbXB0eVZhbGlkYXRvciBmcm9tIFwiLi4vLi4vVmFsaWRhdG9ycy9Ob3RFbXB0eVZhbGlkYXRvclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWYWxpZGF0b3JNYW5hZ2VyXG57XG4gICAgc3RhdGljIHZhbGlkYXRvck1hcCA9IHtcbiAgICAgICAgcmVnZXhwOiAgICAgICAgICAgbmV3IFJlZ2V4VmFsaWRhdG9yKCksXG4gICAgICAgIHN0cmluZ0xlbmd0aDogICAgIG5ldyBTdHJpbmdMZW5ndGhWYWxpZGF0b3IoKSxcbiAgICAgICAgbm90RW1wdHk6ICAgICAgICAgbmV3IE5vdEVtcHR5VmFsaWRhdG9yKClcbiAgICB9XG5cbiAgICBzdGF0aWMgcmVnaXN0ZXJWYWxpZGF0b3IoaGFuZGxlOiBzdHJpbmcsIHZhbGlkYXRvcjogVmFsaWRhdG9yKTogVmFsaWRhdG9yTWFuYWdlclxuICAgIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLnZhbGlkYXRvck1hcFtoYW5kbGVdID0gdmFsaWRhdG9yO1xuICAgICAgICByZXR1cm4gc2VsZjtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0VmFsaWRhdG9ySW5zdGFuY2UoaGFuZGxlOiBzdHJpbmcpOiBudWxsfFZhbGlkYXRvclxuICAgIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBsZXQgdmFsaWRhdG9yID0gdGhpcy52YWxpZGF0b3JNYXBbaGFuZGxlXTtcblxuICAgICAgICBpZiAodmFsaWRhdG9yIGluc3RhbmNlb2YgVmFsaWRhdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsaWRhdG9yO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufSIsImltcG9ydCB7Rm9ybVZhbGlkYXRvclZhbGlkYXRvcnN9IGZyb20gXCIuLi9Gb3JtVmFsaWRhdG9yL1R5cGVzL0Zvcm1WYWxpZGF0b3JWYWxpZGF0b3JzXCI7XG5pbXBvcnQgRmllbGRWYWxpZGF0b3JSZXN1bHQgZnJvbSBcIi4vUmVzdWx0L0ZpZWxkVmFsaWRhdG9yUmVzdWx0XCI7XG5pbXBvcnQgVmFsaWRhdG9yTWFuYWdlciBmcm9tIFwiLi4vVmFsaWRhdG9yL1ZhbGlkYXRvck1hbmFnZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmllbGRWYWxpZGF0b3JcbntcbiAgICBmb3JtOiBIVE1MRm9ybUVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3Rvcihmb3JtOiBIVE1MRm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5mb3JtID0gZm9ybTtcbiAgICB9XG5cbiAgICB2YWxpZGF0ZSh2YWx1ZTogc3RyaW5nLCB2YWxpZGF0b3JzOiBGb3JtVmFsaWRhdG9yVmFsaWRhdG9ycyk6IEZpZWxkVmFsaWRhdG9yUmVzdWx0XG4gICAge1xuICAgICAgICBsZXQgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbXSxcbiAgICAgICAgICAgIGZhaWxlZFZhbGlkYXRvcnM6IFtdXG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yIChsZXQgW2hhbmRsZSwgcGFyYW1zXSBvZiBPYmplY3QuZW50cmllcyh2YWxpZGF0b3JzKSkge1xuXG4gICAgICAgICAgICBsZXQgdmFsaWRhdG9yID0gVmFsaWRhdG9yTWFuYWdlci5nZXRWYWxpZGF0b3JJbnN0YW5jZShoYW5kbGUpO1xuXG4gICAgICAgICAgICBpZiAoIXZhbGlkYXRvci5jaGVjayh2YWx1ZSwgcGFyYW1zKSkge1xuXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UudmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5tZXNzYWdlcy5wdXNoKHBhcmFtcy5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5mYWlsZWRWYWxpZGF0b3JzLnB1c2goaGFuZGxlKTtcblxuICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0b3IuYnJlYWtTZXF1ZW5jZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9XG59IiwiaW1wb3J0IHtQbHVnaW59IGZyb20gXCIuL1BsdWdpblwiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL0Zvcm1WYWxpZGF0b3IvRm9ybVZhbGlkYXRvclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQbHVnaW5NYW5hZ2VyXG57XG4gICAgc3RhdGljIHBsdWdpbnM6IEFycmF5PGFueT47XG5cbiAgICBzdGF0aWMgYmluZChmb3JtVmFsaWRhdG9yOiBGb3JtVmFsaWRhdG9yKTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5wbHVnaW5zID0gZm9ybVZhbGlkYXRvci5wbHVnaW5zO1xuXG4gICAgICAgIGlmICghdGhpcy5wbHVnaW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5nZXRQbHVnaW5zKCkuZm9yRWFjaCgocGx1Z2luKSA9PiB7XG5cbiAgICAgICAgICAgIHBsdWdpbi5pbml0KCk7XG5cbiAgICAgICAgICAgIGZvcm1WYWxpZGF0b3Iub24oJ2Z2LmZpZWxkLmludmFsaWQnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBwbHVnaW4ub25GaWVsZEludmFsaWQoZXZlbnQuZmllbGQsIGV2ZW50LnJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZm9ybVZhbGlkYXRvci5vbignZnYuZmllbGQudmFsaWQnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBwbHVnaW4ub25GaWVsZFZhbGlkKGV2ZW50LmZpZWxkKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmb3JtVmFsaWRhdG9yLm9uKCdmdi5mb3JtLmludmFsaWQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLm9uRm9ybUludmFsaWQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzdGF0aWMgYWRkUGx1Z2luKHBsdWdpbjogUGx1Z2luKTogUGx1Z2luTWFuYWdlclxuICAgIHtcbiAgICAgICAgdGhpcy5wbHVnaW5zLnB1c2gocGx1Z2luKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRQbHVnaW5zKCk6IEFycmF5PFBsdWdpbj5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnBsdWdpbnM7XG4gICAgfVxufSIsImltcG9ydCBWYWxpZGF0b3JSZXNwb25zZSBmcm9tIFwiLi4vVmFsaWRhdG9yL1Jlc3BvbnNlL1ZhbGlkYXRvclJlc3BvbnNlXCI7XG5pbXBvcnQgRmllbGRWYWxpZGF0b3JSZXN1bHQgZnJvbSBcIi4uL0ZpZWxkVmFsaWRhdG9yL1Jlc3VsdC9GaWVsZFZhbGlkYXRvclJlc3VsdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFdmVudEhhbmRsZXJcbntcbiAgICBmb3JtOiBIVE1MRm9ybUVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3Rvcihmb3JtOiBIVE1MRm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5mb3JtID0gZm9ybTtcbiAgICB9XG5cbiAgICBidWlsZEN1c3RvbUV2ZW50KG5hbWU6IHN0cmluZywgZGV0YWlsOiBPYmplY3QpOiBDdXN0b21FdmVudFxuICAgIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDdXN0b21FdmVudChuYW1lLCB7XG4gICAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGRldGFpbDogZGV0YWlsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRyaWdnZXJFdmVudChuYW1lOiBzdHJpbmcsIGRldGFpbDogT2JqZWN0KTogdm9pZFxuICAgIHtcbiAgICAgICAgdGhpcy5mb3JtLmRpc3BhdGNoRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmJ1aWxkQ3VzdG9tRXZlbnQobmFtZSwgZGV0YWlsKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHRyaWdnZXJJbnZhbGlkRmllbGQoZmllbGQ6IHN0cmluZywgcmVzdWx0OiBGaWVsZFZhbGlkYXRvclJlc3VsdCk6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdmdi5maWVsZC5pbnZhbGlkJywge1xuICAgICAgICAgICAgICAgIGZvcm06IHRoaXMuZm9ybSxcbiAgICAgICAgICAgICAgICBmaWVsZDogZmllbGQsXG4gICAgICAgICAgICAgICAgcmVzdWx0OiByZXN1bHRcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgIH1cblxuICAgIHRyaWdnZXJWYWxpZEZpZWxkKGZpZWxkOiBzdHJpbmcpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnRyaWdnZXJFdmVudCgnZnYuZmllbGQudmFsaWQnLCB7XG4gICAgICAgICAgICAgICAgZm9ybTogdGhpcy5mb3JtLFxuICAgICAgICAgICAgICAgIGZpZWxkOiBmaWVsZFxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHRyaWdnZXJJbnZhbGlkRm9ybSgpOiB2b2lkXG4gICAge1xuICAgICAgICB0aGlzLnRyaWdnZXJFdmVudCgnZnYuZm9ybS5pbnZhbGlkJywge1xuICAgICAgICAgICAgICAgIGZvcm06IHRoaXMuZm9ybVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cbn0iLCJpbXBvcnQge0Zvcm1WYWxpZGF0b3JPcHRpb25zfSBmcm9tIFwiLi9UeXBlcy9Gb3JtVmFsaWRhdG9yT3B0aW9uc1wiO1xuaW1wb3J0IHtGb3JtVmFsaWRhdG9yVmFsaWRhdG9yc30gZnJvbSBcIi4vVHlwZXMvRm9ybVZhbGlkYXRvclZhbGlkYXRvcnNcIjtcbmltcG9ydCBGaWVsZFZhbGlkYXRvciBmcm9tIFwiLi4vRmllbGRWYWxpZGF0b3IvRmllbGRWYWxpZGF0b3JcIjtcbmltcG9ydCBQbHVnaW5NYW5hZ2VyIGZyb20gXCIuLi9QbHVnaW4vUGx1Z2luTWFuYWdlclwiO1xuaW1wb3J0IEV2ZW50SGFuZGxlciBmcm9tIFwiLi4vRXZlbnQvRXZlbnRIYW5kbGVyXCI7XG5pbXBvcnQge1BsdWdpbn0gZnJvbSBcIi4uL1BsdWdpbi9QbHVnaW5cIjtcblxuLyoqXG4gKiBGb3JtVmFsaWRhdG9yXG4gKlxuICogQGF1dGhvciBKYWNvYiBGaXR6cGF0cmljayA8Y29udGFjdEBqYWNvYmZpdHpwLmNvLnVrPlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yXG57XG4gICAgZm9ybTogSFRNTEZvcm1FbGVtZW50O1xuICAgIG9wdGlvbnM6IEZvcm1WYWxpZGF0b3JPcHRpb25zO1xuICAgIHZhbGlkOiBib29sZWFuO1xuICAgIGZpZWxkVmFsaWRhdG9yOiBGaWVsZFZhbGlkYXRvcjtcbiAgICBldmVudEhhbmRsZXI6IEV2ZW50SGFuZGxlclxuICAgIHBsdWdpbnM6IEFycmF5PFBsdWdpbj5cblxuICAgIGNvbnN0cnVjdG9yKGZvcm06IEhUTUxGb3JtRWxlbWVudCwgb3B0aW9uczogRm9ybVZhbGlkYXRvck9wdGlvbnMpIHtcblxuICAgICAgICB0aGlzLmZvcm0gPSBmb3JtO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLmZpZWxkVmFsaWRhdG9yID0gbmV3IEZpZWxkVmFsaWRhdG9yKGZvcm0pO1xuICAgICAgICB0aGlzLmV2ZW50SGFuZGxlciA9IG5ldyBFdmVudEhhbmRsZXIoZm9ybSk7XG4gICAgICAgIHRoaXMucGx1Z2lucyA9IG9wdGlvbnMucGx1Z2lucyB8fCBbXTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQmluZCBwbHVnaW4gbWFuYWdlciB0byB0aGlzIHZhbGlkYXRvciBpbnN0YW5jZS5cbiAgICAgICAgICogV2lsbCBjb25maWd1cmUgYWxsIHRoZSByZXF1aXJlZCBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgICogYW5kIGxpbmsgdGhlbSB0byByZWdpc3RlcmVkIHBsdWdpbnMuXG4gICAgICAgICAqL1xuICAgICAgICBQbHVnaW5NYW5hZ2VyLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXIgZXZlbnQgbGlzdGVuZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudEhhbmRsZVxuICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAqL1xuICAgIG9uKGV2ZW50SGFuZGxlOiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbik6IHZvaWRcbiAgICB7XG4gICAgICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKGV2ZW50SGFuZGxlLCAoZXZlbnQpID0+IHsgY2FsbGJhY2soZXZlbnQpIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBuZXcgZmllbGQgdG8gdmFsaWRhdG9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgICAqIEBwYXJhbSB7Rm9ybVZhbGlkYXRvclZhbGlkYXRvcnN9IHZhbGlkYXRvcnNcbiAgICAgKi9cbiAgICBhZGRGaWVsZChuYW1lOiBzdHJpbmcsIHZhbGlkYXRvcnM6IEZvcm1WYWxpZGF0b3JWYWxpZGF0b3JzKTogRm9ybVZhbGlkYXRvclxuICAgIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmZpZWxkc1tuYW1lXSA9IHZhbGlkYXRvcnM7XG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50TGlzdGVuZXJzRm9yRmllbGQoXG4gICAgICAgICAgICB0aGlzLmdldEZpZWxkRWxlbWVudChuYW1lKSxcbiAgICAgICAgICAgIG5hbWVcbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZmllbGRzXG4gICAgICovXG4gICAgZ2V0RmllbGRzKCk6IEFycmF5PHN0cmluZz5cbiAgICB7XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLm9wdGlvbnMuZmllbGRzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcHJvcGVydGllcyBmb3IgZ2l2ZW4gZmllbGQgYnkgbmFtZVxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKi9cbiAgICBnZXRGaWVsZChuYW1lOiBzdHJpbmcpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmZpZWxkc1tuYW1lXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZWxlbWVudCBmb3IgZ2l2ZW4gZmllbGQgYnkgbmFtZVxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKi9cbiAgICBnZXRGaWVsZEVsZW1lbnQobmFtZTogc3RyaW5nKTogSFRNTEVsZW1lbnRcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcm0ucXVlcnlTZWxlY3RvcignW25hbWU9XCInICsgbmFtZSArICdcIl0nKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmaWVsZHMgYXMgZWxlbWVudHNcbiAgICAgKi9cbiAgICBnZXRGaWVsZEVsZW1lbnRzKCk6IEFycmF5PEhUTUxFbGVtZW50PlxuICAgIHtcbiAgICAgICAgbGV0IGZpZWxkcyA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGZpZWxkTmFtZSBpbiB0aGlzLm9wdGlvbnMuZmllbGRzKSB7XG4gICAgICAgICAgICBmaWVsZHMucHVzaCh0aGlzLmdldEZpZWxkRWxlbWVudChmaWVsZE5hbWUpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmaWVsZHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZmllbGRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZFxuICAgICAqL1xuICAgIHZhbGlkYXRlRmllbGQoZmllbGQ6IHN0cmluZyk6IEZvcm1WYWxpZGF0b3JcbiAgICB7XG4gICAgICAgIGxldCBmaWVsZEVsZW1lbnQgPSB0aGlzLmdldEZpZWxkRWxlbWVudChmaWVsZCksXG4gICAgICAgICAgICBmaWVsZFZhbGlkYXRvcnMgPSB0aGlzLmdldEZpZWxkKGZpZWxkKSxcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuZmllbGRWYWxpZGF0b3IudmFsaWRhdGUoXG4gICAgICAgICAgICAgICAgZmllbGRFbGVtZW50Wyd2YWx1ZSddLFxuICAgICAgICAgICAgICAgIGZpZWxkVmFsaWRhdG9yc1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgZmllbGQgaXMgaW52YWxpZCB0aGVuIG92ZXJyaWRlIHRoZSB2YWxpZFxuICAgICAgICAgKiBwcm9wZXJ0eSwgdGhpcyBpbnZhbGlkYXRlcyB0aGUgd2hvbGUgZm9ybS5cbiAgICAgICAgICovXG4gICAgICAgIGlmICghcmVzdWx0LnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50SGFuZGxlci50cmlnZ2VySW52YWxpZEZpZWxkKGZpZWxkLCByZXN1bHQpO1xuICAgICAgICAgICAgdGhpcy52YWxpZCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ldmVudEhhbmRsZXIudHJpZ2dlclZhbGlkRmllbGQoZmllbGQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZm9ybVxuICAgICAqL1xuICAgIHZhbGlkYXRlRm9ybSgpOiBGb3JtVmFsaWRhdG9yXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICogQXNzdW1lIGZvcm0gaXMgdmFsaWQgdG8gYmVnaW4gd2l0aDpcbiAgICAgICAgICogVGhpcyB3aWxsIGJlIG92ZXJyaWRlbiBpZiB3ZSBjb21lIGFjcm9zcyBhblxuICAgICAgICAgKiBlcnJvbmVvdXMgZmllbGQgaW4gdGhlIG5leHQgc3RlcC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmFsaWQgPSB0cnVlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb29wIHRocm91Z2ggZmllbGRzIGFuZCB2YWxpZGF0ZSB0aGVtLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5nZXRGaWVsZHMoKS5mb3JFYWNoKChmaWVsZCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZUZpZWxkKGZpZWxkKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXMgdGhlIGZvcm0gdmFsaWRcbiAgICAgKi9cbiAgICBpc0Zvcm1WYWxpZCgpOiBib29sZWFuXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy52YWxpZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBldmVudCBsaXN0ZW5lcnMgZm9yIGZpZWxkXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGRcbiAgICAgKiBAcGFyYW0gZmllbGROYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnNGb3JGaWVsZChmaWVsZDogSFRNTEVsZW1lbnQsIGZpZWxkTmFtZTogc3RyaW5nKVxuICAgIHtcbiAgICAgICAgaWYgKGZpZWxkLmdldEF0dHJpYnV0ZSgndmFsdWUnKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZUZpZWxkKGZpZWxkTmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmaWVsZC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZUZpZWxkKGZpZWxkTmFtZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyc1xuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKVxuICAgIHtcbiAgICAgICAgdGhpcy5nZXRGaWVsZHMoKS5mb3JFYWNoKChmaWVsZCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50TGlzdGVuZXJzRm9yRmllbGQodGhpcy5nZXRGaWVsZEVsZW1lbnQoZmllbGQpLCBmaWVsZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlRm9ybSgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5pc0Zvcm1WYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTdWJtaXQoZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgdmFsaWQgZm9ybSBzdWJtaXRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBoYW5kbGVTdWJtaXQoZXZlbnQ6IFN1Ym1pdEV2ZW50KVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHRoZSBzdWJtaXQgY2FsbGJhY2sgaXMgc2V0IHRoZW4gY2FsbCBpdC5cbiAgICAgICAgICogSWYgdGhlIGNhbGxiYWNrIHJldHVybnMgdHJ1ZSB0aGVuIHdlIHdpbGwgbm90IHN1Ym1pdFxuICAgICAgICAgKiB0aGUgZm9ybS4gVGhpcyBpcyB1c2VmdWwgaWYgY3VzdG9tIGxvZ2ljIGlzIG5lZWRlZCBmb3JcbiAgICAgICAgICogZm9ybSBzdWJtaXRpb24sIGZvciBleGFtcGxlIHN1Ym1pdHRpbmcgdXNpbmcgYWpheC5cbiAgICAgICAgICovXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc3VibWl0Q2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMub3B0aW9ucy5zdWJtaXRDYWxsYmFjayhldmVudCk7XG5cbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZm9ybS5zdWJtaXQoKTtcbiAgICB9XG59Il0sIm5hbWVzIjpbImJyZWFrU2VxdWVuY2UiLCJjaGVjayIsInZhbHVlIiwicGFyYW1zIiwidGVzdCIsImxlbmd0aCIsIm1pbiIsIm1heCIsInJlZ2lzdGVyVmFsaWRhdG9yIiwiaGFuZGxlIiwidmFsaWRhdG9yIiwidGhpcyIsInZhbGlkYXRvck1hcCIsInNlbGYiLCJnZXRWYWxpZGF0b3JJbnN0YW5jZSIsInJlZ2V4cCIsInN0cmluZ0xlbmd0aCIsIm5vdEVtcHR5IiwiZm9ybSIsInZhbGlkYXRlIiwidmFsaWRhdG9ycyIsInJlc3BvbnNlIiwidmFsaWQiLCJtZXNzYWdlcyIsImZhaWxlZFZhbGlkYXRvcnMiLCJPYmplY3QiLCJlbnRyaWVzIiwicHVzaCIsIm1lc3NhZ2UiLCJiaW5kIiwiZm9ybVZhbGlkYXRvciIsInBsdWdpbnMiLCJnZXRQbHVnaW5zIiwiZm9yRWFjaCIsInBsdWdpbiIsImluaXQiLCJvbiIsImV2ZW50Iiwib25GaWVsZEludmFsaWQiLCJmaWVsZCIsInJlc3VsdCIsIm9uRmllbGRWYWxpZCIsIm9uRm9ybUludmFsaWQiLCJhZGRQbHVnaW4iLCJidWlsZEN1c3RvbUV2ZW50IiwibmFtZSIsImRldGFpbCIsIkN1c3RvbUV2ZW50IiwiY2FuY2VsYWJsZSIsInRyaWdnZXJFdmVudCIsImRpc3BhdGNoRXZlbnQiLCJ0cmlnZ2VySW52YWxpZEZpZWxkIiwidHJpZ2dlclZhbGlkRmllbGQiLCJ0cmlnZ2VySW52YWxpZEZvcm0iLCJvcHRpb25zIiwiZmllbGRWYWxpZGF0b3IiLCJldmVudEhhbmRsZXIiLCJyZWdpc3RlckV2ZW50TGlzdGVuZXJzIiwiZXZlbnRIYW5kbGUiLCJjYWxsYmFjayIsImFkZEV2ZW50TGlzdGVuZXIiLCJhZGRGaWVsZCIsImZpZWxkcyIsInJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnNGb3JGaWVsZCIsImdldEZpZWxkRWxlbWVudCIsImdldEZpZWxkcyIsImtleXMiLCJnZXRGaWVsZCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRGaWVsZEVsZW1lbnRzIiwiZmllbGROYW1lIiwidmFsaWRhdGVGaWVsZCIsImZpZWxkRWxlbWVudCIsImZpZWxkVmFsaWRhdG9ycyIsInZhbGlkYXRlRm9ybSIsImlzRm9ybVZhbGlkIiwiZ2V0QXR0cmlidXRlIiwicHJldmVudERlZmF1bHQiLCJoYW5kbGVTdWJtaXQiLCJzdWJtaXRDYWxsYmFjayIsIkZ1bmN0aW9uIiwic3VibWl0Il0sInNvdXJjZVJvb3QiOiIifQ==